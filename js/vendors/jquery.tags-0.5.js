/*jQuery Tags 0.5, Â© ermouth*/
!function(a){function b(a,b){var c,d=0,e=a.data("tags");if(e.data=[],b.length){var f=b.unique();for(e.tv={},a.find(".tag.active").trigger("click"),c=0;c<f.length;c++)e.ti[f[c]]&&(e.$t[f[c]].trigger("click"),d+=1)}d||(null!=e.empty?a.find(".tags-empty").trigger("click"):a.find(".tag.active").trigger("click"))}var c=(Object.isArray,Object.isBoolean,Object.isString),d=(Object.isObject,Object.isNumber),e=(Object.isRegExp,Object.isFunction,a.type,{init:function(e){var f,g,h,i,j,k,l,m,n,o,p,q=a(this),r=[],s=[],t={},u={},v={},w={data:[],tags:[],disabled:!1,event:"change",tagcss:"tag pseudolink ",template:function(a){return('<span class="'+w.tagcss+' {css}" data-value="{value}">{name}</span>').assign(a)},empty:null,tagshim:" ",groupshim:" ",silent:!1},x=a.type(e),y=null;for("object"==x?a.extend(!0,w,e):"array"==x&&(w.tags=e.slice(0)),q.data("tags")&&(w.data=q.data("tags").data.slice(0)),null!=w.empty&&(l=w.empty,x=a.type(l),p="",/^nu|^str/.test(x)?(k="",j=l+""):"object"==x&&(c(l.name)&&(c(l.value)||d(l.value))?(j=l.name+"",k=l.value+"",p=l.css||p):(j=Object.keys(l)[0],k=l[j]+"")),c(k)&&(y=k,t[k]={name:j,i:null,j:null,value:k+"",css:p+" tags-empty"})),g=w.tags,j=0;j<g.length;j++){for(l=g[j],i=[],h=[],x=a.type(l),/^num|^str|^ob/.test(x)?h=[l]:"array"==x&&(h=l.slice(0).unique()),k=0;k<h.length;k++)if(m=h[k],n=a.type(m),/^num|^str/.test(n))i.push({name:m+"",value:m+"",css:""});else if("object"==n)if(c(m.name)&&(c(m.value)||d(m.value)))i.push({name:m.name+"",value:m.value+"",css:c(m.css)?m.css:""});else for(o in m)i.push({name:o+"",value:m[o]+"",css:""});i.length&&s.push(i.slice(0))}for(j=0;j<s.length;j++){for(i=[],k=0;k<s[j].length;k++)l=s[j][k].value,t[l]||(t[l]=!0,i.push(s[j][k]));i.length&&r.push(i.slice(0))}for(j=0;j<r.length;j++)for(k=0;k<r[j].length;k++)l=r[j][k].value,t[l]={name:r[j][k].name,i:j,j:k,value:l,css:(r[j][k].css||"")+" tags-row"+j};for(f="",null!=y&&(f+=w.template(t[y])+w.groupshim),j=0;j<r.length;j++)for(j&&(f+=w.groupshim),k=0;k<r[j].length;k++)k&&(f+=w.tagshim),f+=w.template(t[r[j][k].value]);return q.html(f),q.off(".tag"),q.on("click.tag",".tag",function(){var b,c,d=a(this),e=d.data("value");if(!w.disabled){if(d.is(".tags-empty"))q.find(".tag").removeClass("active"),u={},y&&(u[y]=!0),d.addClass("active");else{if(d.is(".active"))d.removeClass("active"),u[e]=!1;else{for(b=t[e].i,q.find(".tag.tags-row"+b).removeClass("active"),c=0;c<r[b].length;c++)u[r[b][c].value]=!1;d.addClass("active"),u[e]=!0,y&&(u[y]=!1)}Object.values(u).compact(!0).length?q.find(".tags-empty").removeClass("active"):(u={},y&&(u[y]=!0),q.find(".tags-empty").addClass("active"))}w.data=[];for(b in u)u[b]&&w.data.push(b);q.data("value",w.data),w.silent||q.trigger("change")}}),q.find(".tag").each(function(){var b=a(this),c=b.data("value");v[c]=b}),a.extend(w,{ti:t,tv:u,$t:v}),q.addClass("my-tags").data("tags",w),w.silent=!0,b(q,w.data),w.silent=!1,q},disable:function(b){void 0!==b&&(a(this).data("tags").disabled=!!b)},data:function(c){var d=a(this).data("tags"),e=c;return"string"==typeof e&&(e=[c]),d&&e&&"array"==a.type(e)&&!d.disabled?(d.silent=!0,b(a(this),e),d.silent=!1,a(this).data("tags").data):d?d.data:[]}});a.fn.tags=function(b){return e[b]?e[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist in jQuery.tags"),void 0):e.init.apply(this,arguments)}}(jQuery);
